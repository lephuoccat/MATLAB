
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>1</title><meta name="generator" content="MATLAB 8.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-10-04"><meta name="DC.source" content="DSpeechP_HW4.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>1</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Part a)</a></li><li><a href="#2">Part b</a></li><li><a href="#3">Part c</a></li><li><a href="#4">Part 3</a></li><li><a href="#10">Part 6</a></li><li><a href="#11">s5.wav</a></li><li><a href="#12">should.wav</a></li></ul></div><h2>Part a)<a name="1"></a></h2><p>Retangular Window</p><pre class="codeinput">N = 31;
n = [0:1:N-1];
r = @(n) double(n&gt;=0 &amp; n&lt;=N-1);
rf = r(n);
plot(n,rf,<span class="string">'blue'</span>,<span class="string">'LineWidth'</span>,2)
xlabel(<span class="string">'Sample Index, n'</span>);
ylabel(<span class="string">'Amplitude'</span>);
title(<span class="string">'Windows Time Response, N=31'</span>);
axis([0 30 0 1.2]);
hold <span class="string">on</span>

<span class="comment">% TriangularWindow</span>
n1 = [0:1:15];
n2 = [16:1:N-1];
t1 = @(n) n./15;
t2 = @(n) 2-n./15;
tf = [t1(n1) t2(n2)];
plot(n,tf,<span class="string">'green'</span>,<span class="string">'LineWidth'</span>,2)
hold <span class="string">on</span>

<span class="comment">% Hamming Window</span>
n3 = [0:1:N-1];
h1 = @(n) 0.54-0.46*cos(pi.*n./15);
plot(n,h1(n),<span class="string">'cyan'</span>,<span class="string">'LineWidth'</span>,2)
hold <span class="string">on</span>

<span class="comment">% Hanning Window</span>
h2 = @(n) 0.5-0.5*cos(pi.*n./15);
plot(n,h2(n),<span class="string">'red'</span>,<span class="string">'LineWidth'</span>,2)
hold <span class="string">on</span>

<span class="comment">% Blackman Window</span>
h3 = @(n) 0.42-0.5*cos(pi.*n./15)+0.08*cos(2*pi.*n./15);
plot(n,h3(n),<span class="string">'black'</span>,<span class="string">'LineWidth'</span>,2)
legend(<span class="string">'Rectangular'</span>,<span class="string">'Triangular'</span>,<span class="string">'Hamming'</span>,<span class="string">'Hanning'</span>,<span class="string">'Blackman'</span>);
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="DSpeechP_HW4_01.png" alt=""> <h2>Part b<a name="2"></a></h2><pre class="codeinput">f = linspace(0,10000,1024);
R_DFT = fft(rf,1024);
plot(f,20*log10(abs(R_DFT)/max(R_DFT)),<span class="string">'blue'</span>,<span class="string">'LineWidth'</span>,2);
title(<span class="string">'Window Frequency Response, N=31, f_s=10000'</span>);
xlabel(<span class="string">'Frequency (Hz)'</span>);
ylabel(<span class="string">'Log Magnitude (dB)'</span>);
axis([0 5000 -140 0]);
grid <span class="string">on</span>
hold <span class="string">on</span>

T_DFT = fft(tf,1024);
plot(f,20*log10(abs(T_DFT)/max(T_DFT)),<span class="string">'green'</span>,<span class="string">'LineWidth'</span>,2);
hold <span class="string">on</span>

H1_DFT = fft(h1(n),1024);
plot(f,20*log10(abs(H1_DFT)/max(H1_DFT)),<span class="string">'cyan'</span>,<span class="string">'LineWidth'</span>,2);
hold <span class="string">on</span>

H2_DFT = fft(h2(n),1024);
plot(f,20*log10(abs(H2_DFT)/max(H2_DFT)),<span class="string">'red'</span>,<span class="string">'LineWidth'</span>,2);
hold <span class="string">on</span>

H3_DFT = fft(h3(n),1024);
plot(f,20*log10(abs(H3_DFT)/max(H3_DFT)),<span class="string">'black'</span>,<span class="string">'LineWidth'</span>,2);
legend(<span class="string">'Rectangular'</span>,<span class="string">'Triangular'</span>,<span class="string">'Hamming'</span>,<span class="string">'Hanning'</span>,<span class="string">'Blackman'</span>);
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="DSpeechP_HW4_02.png" alt=""> <h2>Part c<a name="3"></a></h2><pre class="codeinput">f = linspace(0,10000,1024);
R_DFT = fft(rf,1024);
plot(f,20*log10(abs(R_DFT)/max(R_DFT)),<span class="string">'blue'</span>,<span class="string">'LineWidth'</span>,2);
title(<span class="string">'Window Frequency Response, N=31, f_s=10000'</span>);
xlabel(<span class="string">'Frequency (Hz)'</span>);
ylabel(<span class="string">'Log Magnitude (dB)'</span>);
axis([0 1290.4 -104 0]);
grid <span class="string">on</span>
hold <span class="string">on</span>

T_DFT = fft(tf,1024);
plot(f,20*log10(abs(T_DFT)/max(T_DFT)),<span class="string">'green'</span>,<span class="string">'LineWidth'</span>,2);
hold <span class="string">on</span>

H1_DFT = fft(h1(n),1024);
plot(f,20*log10(abs(H1_DFT)/max(H1_DFT)),<span class="string">'cyan'</span>,<span class="string">'LineWidth'</span>,2);
hold <span class="string">on</span>

H2_DFT = fft(h2(n),1024);
plot(f,20*log10(abs(H2_DFT)/max(H2_DFT)),<span class="string">'red'</span>,<span class="string">'LineWidth'</span>,2);
hold <span class="string">on</span>

H3_DFT = fft(h3(n),1024);
plot(f,20*log10(abs(H3_DFT)/max(H3_DFT)),<span class="string">'black'</span>,<span class="string">'LineWidth'</span>,2);
legend(<span class="string">'Rectangular'</span>,<span class="string">'Triangular'</span>,<span class="string">'Hamming'</span>,<span class="string">'Hanning'</span>,<span class="string">'Blackman'</span>);
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="DSpeechP_HW4_03.png" alt=""> <h2>Part 3<a name="4"></a></h2><pre class="codeinput">t = -10:0.01:10;
y = 2*exp(-t.^2);
plot(t,y)
title(<span class="string">'2e^{-\tau^2}'</span>)
axis([-5 5 0 2.5])
grid <span class="string">on</span>
</pre><img vspace="5" hspace="5" src="DSpeechP_HW4_04.png" alt=""> <pre class="codeinput">y = abs(t).*exp(-abs(t));
plot(t,y)
title(<span class="string">'|\tau|e^{-|\tau|}'</span>)
grid <span class="string">on</span>
</pre><img vspace="5" hspace="5" src="DSpeechP_HW4_05.png" alt=""> <pre class="codeinput">y = (sin(pi*t)./(pi*t)).^2;
plot(t,y)
title(<span class="string">'[sin(\pi t)/ \pi t]^2'</span>)
grid <span class="string">on</span>
</pre><img vspace="5" hspace="5" src="DSpeechP_HW4_06.png" alt=""> <pre class="codeinput">y = 2*(t.^2+4)./(t.^2+6);
plot(t,y);
title(<span class="string">'2(t^2+4)/(t^2+6)'</span>)
grid <span class="string">on</span>
</pre><img vspace="5" hspace="5" src="DSpeechP_HW4_07.png" alt=""> <pre class="codeinput">y = (0.2*cos(3*pi.*t)).^2;
plot(t,y)
title(<span class="string">'[0.2cos(3\pi\tau)]^3'</span>)
axis([-1 1 0 0.05])
grid <span class="string">on</span>
</pre><img vspace="5" hspace="5" src="DSpeechP_HW4_08.png" alt=""> <h2>Part 6<a name="10"></a></h2><h2>s5.wav<a name="11"></a></h2><pre class="codeinput">N1 = 40;                                        <span class="comment">% duration 5(msec)</span>
n1 = [0:1:N1-1];
r1 = @(n) double(n&gt;=0 &amp; n&lt;=N1-1);
rf1 = r1(n1);

N2 = 80;                                        <span class="comment">% window duration 10(msec)</span>
n2 = [0:1:N2-1];
r2 = @(n) double(n&gt;=0 &amp; n&lt;=N2-1);
rf2 = r2(n2);

N3 = 160;                                       <span class="comment">% window duration 20(msec)</span>
n3 = [0:1:N3-1];
r3 = @(n) double(n&gt;=0 &amp; n&lt;=N3-1);
rf3 = r3(n3);

N4 = 320;                                       <span class="comment">% window duration 40(msec)</span>
n4 = [0:1:N4-1];
r4 = @(n) double(n&gt;=0 &amp; n&lt;=N4-1);
rf4 = r4(n4);

[y1,fs1,bit1,fmt1] = loadwav(<span class="string">'s5.wav'</span>);         <span class="comment">% load the speech file (s5.wav)</span>

t1 = [1:1:size(y1)];
t_reduce = [1:80:size(y1)];                     <span class="comment">% time shift 10(msec)</span>
endpoint = size(y1);

En1 = conv(y1.^2,rf1);                           <span class="comment">% short-time energy</span>
En2 = conv(y1.^2,rf2);
En3 = conv(y1.^2,rf3);
En4 = conv(y1.^2,rf4);

Mn1 = conv(abs(y1),rf1);                          <span class="comment">% short-time magnitude</span>
Mn2 = conv(abs(y1),rf2);
Mn3 = conv(abs(y1),rf3);
Mn4 = conv(abs(y1),rf4);

y1_shift =  [0;y1(1:1:endpoint-1)];
firstDiff = sgn(y1)-sgn(y1_shift);
absFirstDiff = abs(firstDiff);
Zn1 = conv(absFirstDiff,rf1);                     <span class="comment">% short-time zero-crossing</span>
Zn2 = conv(absFirstDiff,rf2);
Zn3 = conv(absFirstDiff,rf3);
Zn4 = conv(absFirstDiff,rf4);

subplot(4,1,1); plot(t1/fs1,y1);
title(<span class="string">'s5.wav Speech Waveform'</span>);
legend(<span class="string">'signal'</span>);
ylabel(<span class="string">'Amplitude'</span>);
axis([0 3 -4E4 4E4]);

subplot(4,1,2);
plot(t_reduce/fs1,En1(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,En2(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,En3(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,En4(t_reduce),<span class="string">'LineWidth'</span>,2);
legend(<span class="string">'duration: 5msec'</span>,<span class="string">'duration: 10msec'</span>,<span class="string">'duration: 20msec'</span>,<span class="string">'duration: 40msec'</span>);
ylabel(<span class="string">'Short-time Energy'</span>);
axis([0 3 0 60E9]);

subplot(4,1,3);
plot(t_reduce/fs1,Mn1(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Mn2(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Mn3(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Mn4(t_reduce),<span class="string">'LineWidth'</span>,2);
legend(<span class="string">'duration: 5msec'</span>,<span class="string">'duration: 10msec'</span>,<span class="string">'duration: 20msec'</span>,<span class="string">'duration: 40msec'</span>);
ylabel(<span class="string">'Short-time Magnitude'</span>);
axis([0 3 0 40E5]);

subplot(4,1,4);
plot(t_reduce/fs1,Zn1(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Zn2(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Zn3(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Zn4(t_reduce),<span class="string">'LineWidth'</span>,2);
legend(<span class="string">'duration: 5msec'</span>,<span class="string">'duration: 10msec'</span>,<span class="string">'duration: 20msec'</span>,<span class="string">'duration: 40msec'</span>);
xlabel(<span class="string">'Time (sec)'</span>);
ylabel(<span class="string">'Short-time Zero-crossing'</span>);
axis([0 3 0 500]);
</pre><img vspace="5" hspace="5" src="DSpeechP_HW4_09.png" alt=""> <h2>should.wav<a name="12"></a></h2><pre class="codeinput">N1 = 52;                                        <span class="comment">% duration 5(msec)</span>
n1 = [0:1:N1-1];
r1 = @(n) double(n&gt;=0 &amp; n&lt;=N1-1);
rf1 = r1(n1);

N2 = 104;                                        <span class="comment">% window duration 10(msec)</span>
n2 = [0:1:N2-1];
r2 = @(n) double(n&gt;=0 &amp; n&lt;=N2-1);
rf2 = r2(n2);

N3 = 208;                                        <span class="comment">% window duration 20(msec)</span>
n3 = [0:1:N3-1];
r3 = @(n) double(n&gt;=0 &amp; n&lt;=N3-1);
rf3 = r3(n3);

N4 = 416;                                        <span class="comment">% window duration 40(msec)</span>
n4 = [0:1:N4-1];
r4 = @(n) double(n&gt;=0 &amp; n&lt;=N4-1);
rf4 = r4(n4);

[y1,fs1,bit1,fmt1] = loadwav(<span class="string">'should.wav'</span>);      <span class="comment">% load the speech file (should.wav)</span>

t1 = [1:1:size(y1)];
t_reduce = [1:104:size(y1)];                     <span class="comment">% time shift 10(msec)</span>
endpoint = size(y1);

En1 = conv(y1.^2,rf1);                           <span class="comment">% short-time energy</span>
En2 = conv(y1.^2,rf2);
En3 = conv(y1.^2,rf3);
En4 = conv(y1.^2,rf4);

Mn1 = conv(abs(y1),rf1);                          <span class="comment">% short-time magnitude</span>
Mn2 = conv(abs(y1),rf2);
Mn3 = conv(abs(y1),rf3);
Mn4 = conv(abs(y1),rf4);

y1_shift =  [0;y1(1:1:endpoint-1)];
firstDiff = sgn(y1)-sgn(y1_shift);
absFirstDiff = abs(firstDiff);
Zn1 = conv(absFirstDiff,rf1);                     <span class="comment">% short-time zero-crossing</span>
Zn2 = conv(absFirstDiff,rf2);
Zn3 = conv(absFirstDiff,rf3);
Zn4 = conv(absFirstDiff,rf4);

subplot(4,1,1); plot(t1/fs1,y1);
title(<span class="string">'s5.wav Speech Waveform'</span>);
legend(<span class="string">'signal'</span>);
ylabel(<span class="string">'Amplitude'</span>);
axis([0 1.1 -1.5E4 1.5E4]);

subplot(4,1,2);
plot(t_reduce/fs1,En1(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,En2(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,En3(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,En4(t_reduce),<span class="string">'LineWidth'</span>,2);
legend(<span class="string">'duration: 5msec'</span>,<span class="string">'duration: 10msec'</span>,<span class="string">'duration: 20msec'</span>,<span class="string">'duration: 40msec'</span>);
ylabel(<span class="string">'Short-time Energy'</span>);
axis([0 1.1 0 10E9]);

subplot(4,1,3);
plot(t_reduce/fs1,Mn1(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Mn2(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Mn3(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Mn4(t_reduce),<span class="string">'LineWidth'</span>,2);
legend(<span class="string">'duration: 5msec'</span>,<span class="string">'duration: 10msec'</span>,<span class="string">'duration: 20msec'</span>,<span class="string">'duration: 40msec'</span>);
ylabel(<span class="string">'Short-time Magnitude'</span>);
axis([0 1.1 0 20E5]);

subplot(4,1,4);
plot(t_reduce/fs1,Zn1(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Zn2(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Zn3(t_reduce),<span class="string">'LineWidth'</span>,2); hold <span class="string">on</span>
plot(t_reduce/fs1,Zn4(t_reduce),<span class="string">'LineWidth'</span>,2);
legend(<span class="string">'duration: 5msec'</span>,<span class="string">'duration: 10msec'</span>,<span class="string">'duration: 20msec'</span>,<span class="string">'duration: 40msec'</span>);
xlabel(<span class="string">'Time (sec)'</span>);
ylabel(<span class="string">'Short-time Zero-crossing'</span>);
axis([0 1.1 0 600]);
</pre><img vspace="5" hspace="5" src="DSpeechP_HW4_10.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 1
%% Part a) 
% Retangular Window
N = 31;
n = [0:1:N-1];
r = @(n) double(n>=0 & n<=N-1);
rf = r(n);
plot(n,rf,'blue','LineWidth',2)
xlabel('Sample Index, n');
ylabel('Amplitude');
title('Windows Time Response, N=31');
axis([0 30 0 1.2]);
hold on

% TriangularWindow
n1 = [0:1:15];
n2 = [16:1:N-1];
t1 = @(n) n./15;
t2 = @(n) 2-n./15;
tf = [t1(n1) t2(n2)];
plot(n,tf,'green','LineWidth',2)
hold on

% Hamming Window
n3 = [0:1:N-1];
h1 = @(n) 0.54-0.46*cos(pi.*n./15);
plot(n,h1(n),'cyan','LineWidth',2)            
hold on

% Hanning Window
h2 = @(n) 0.5-0.5*cos(pi.*n./15);
plot(n,h2(n),'red','LineWidth',2)           
hold on

% Blackman Window
h3 = @(n) 0.42-0.5*cos(pi.*n./15)+0.08*cos(2*pi.*n./15);
plot(n,h3(n),'black','LineWidth',2)           
legend('Rectangular','Triangular','Hamming','Hanning','Blackman');
hold off

%% Part b
f = linspace(0,10000,1024);
R_DFT = fft(rf,1024);
plot(f,20*log10(abs(R_DFT)/max(R_DFT)),'blue','LineWidth',2);
title('Window Frequency Response, N=31, f_s=10000');
xlabel('Frequency (Hz)');
ylabel('Log Magnitude (dB)');
axis([0 5000 -140 0]);
grid on
hold on

T_DFT = fft(tf,1024);
plot(f,20*log10(abs(T_DFT)/max(T_DFT)),'green','LineWidth',2);
hold on

H1_DFT = fft(h1(n),1024);
plot(f,20*log10(abs(H1_DFT)/max(H1_DFT)),'cyan','LineWidth',2);
hold on

H2_DFT = fft(h2(n),1024);
plot(f,20*log10(abs(H2_DFT)/max(H2_DFT)),'red','LineWidth',2);
hold on

H3_DFT = fft(h3(n),1024);
plot(f,20*log10(abs(H3_DFT)/max(H3_DFT)),'black','LineWidth',2);
legend('Rectangular','Triangular','Hamming','Hanning','Blackman');
hold off

%% Part c
f = linspace(0,10000,1024);
R_DFT = fft(rf,1024);
plot(f,20*log10(abs(R_DFT)/max(R_DFT)),'blue','LineWidth',2);
title('Window Frequency Response, N=31, f_s=10000');
xlabel('Frequency (Hz)');
ylabel('Log Magnitude (dB)');
axis([0 1290.4 -104 0]);
grid on
hold on

T_DFT = fft(tf,1024);
plot(f,20*log10(abs(T_DFT)/max(T_DFT)),'green','LineWidth',2);
hold on

H1_DFT = fft(h1(n),1024);
plot(f,20*log10(abs(H1_DFT)/max(H1_DFT)),'cyan','LineWidth',2);
hold on

H2_DFT = fft(h2(n),1024);
plot(f,20*log10(abs(H2_DFT)/max(H2_DFT)),'red','LineWidth',2);
hold on

H3_DFT = fft(h3(n),1024);
plot(f,20*log10(abs(H3_DFT)/max(H3_DFT)),'black','LineWidth',2);
legend('Rectangular','Triangular','Hamming','Hanning','Blackman');
hold off

%% Part 3
%%
t = -10:0.01:10;
y = 2*exp(-t.^2);
plot(t,y)
title('2e^{-\tau^2}')
axis([-5 5 0 2.5])
grid on

%%
y = abs(t).*exp(-abs(t));
plot(t,y)
title('|\tau|e^{-|\tau|}')
grid on

%%
y = (sin(pi*t)./(pi*t)).^2;
plot(t,y)
title('[sin(\pi t)/ \pi t]^2')
grid on

%%
y = 2*(t.^2+4)./(t.^2+6);
plot(t,y);
title('2(t^2+4)/(t^2+6)')
grid on

%%
y = (0.2*cos(3*pi.*t)).^2;
plot(t,y)
title('[0.2cos(3\pi\tau)]^3')
axis([-1 1 0 0.05])
grid on

%% Part 6
%% s5.wav
N1 = 40;                                        % duration 5(msec)
n1 = [0:1:N1-1];
r1 = @(n) double(n>=0 & n<=N1-1);
rf1 = r1(n1);

N2 = 80;                                        % window duration 10(msec)
n2 = [0:1:N2-1];
r2 = @(n) double(n>=0 & n<=N2-1);
rf2 = r2(n2);

N3 = 160;                                       % window duration 20(msec)
n3 = [0:1:N3-1];
r3 = @(n) double(n>=0 & n<=N3-1);
rf3 = r3(n3);

N4 = 320;                                       % window duration 40(msec)
n4 = [0:1:N4-1];
r4 = @(n) double(n>=0 & n<=N4-1);
rf4 = r4(n4);

[y1,fs1,bit1,fmt1] = loadwav('s5.wav');         % load the speech file (s5.wav)

t1 = [1:1:size(y1)];
t_reduce = [1:80:size(y1)];                     % time shift 10(msec)
endpoint = size(y1); 

En1 = conv(y1.^2,rf1);                           % short-time energy
En2 = conv(y1.^2,rf2);
En3 = conv(y1.^2,rf3);
En4 = conv(y1.^2,rf4);

Mn1 = conv(abs(y1),rf1);                          % short-time magnitude
Mn2 = conv(abs(y1),rf2);
Mn3 = conv(abs(y1),rf3);
Mn4 = conv(abs(y1),rf4);

y1_shift =  [0;y1(1:1:endpoint-1)];
firstDiff = sgn(y1)-sgn(y1_shift);
absFirstDiff = abs(firstDiff);
Zn1 = conv(absFirstDiff,rf1);                     % short-time zero-crossing
Zn2 = conv(absFirstDiff,rf2);
Zn3 = conv(absFirstDiff,rf3);
Zn4 = conv(absFirstDiff,rf4);

subplot(4,1,1); plot(t1/fs1,y1);
title('s5.wav Speech Waveform');
legend('signal');
ylabel('Amplitude');
axis([0 3 -4E4 4E4]);

subplot(4,1,2); 
plot(t_reduce/fs1,En1(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,En2(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,En3(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,En4(t_reduce),'LineWidth',2);
legend('duration: 5msec','duration: 10msec','duration: 20msec','duration: 40msec');
ylabel('Short-time Energy');
axis([0 3 0 60E9]);

subplot(4,1,3); 
plot(t_reduce/fs1,Mn1(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Mn2(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Mn3(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Mn4(t_reduce),'LineWidth',2);
legend('duration: 5msec','duration: 10msec','duration: 20msec','duration: 40msec');
ylabel('Short-time Magnitude');
axis([0 3 0 40E5]);

subplot(4,1,4); 
plot(t_reduce/fs1,Zn1(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Zn2(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Zn3(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Zn4(t_reduce),'LineWidth',2);
legend('duration: 5msec','duration: 10msec','duration: 20msec','duration: 40msec');
xlabel('Time (sec)');
ylabel('Short-time Zero-crossing');
axis([0 3 0 500]);

%% should.wav
N1 = 52;                                        % duration 5(msec)
n1 = [0:1:N1-1];
r1 = @(n) double(n>=0 & n<=N1-1);
rf1 = r1(n1);

N2 = 104;                                        % window duration 10(msec)
n2 = [0:1:N2-1];
r2 = @(n) double(n>=0 & n<=N2-1);
rf2 = r2(n2);

N3 = 208;                                        % window duration 20(msec)
n3 = [0:1:N3-1];
r3 = @(n) double(n>=0 & n<=N3-1);
rf3 = r3(n3);

N4 = 416;                                        % window duration 40(msec)
n4 = [0:1:N4-1];
r4 = @(n) double(n>=0 & n<=N4-1);
rf4 = r4(n4);

[y1,fs1,bit1,fmt1] = loadwav('should.wav');      % load the speech file (should.wav)

t1 = [1:1:size(y1)];
t_reduce = [1:104:size(y1)];                     % time shift 10(msec)
endpoint = size(y1); 

En1 = conv(y1.^2,rf1);                           % short-time energy
En2 = conv(y1.^2,rf2);
En3 = conv(y1.^2,rf3);
En4 = conv(y1.^2,rf4);

Mn1 = conv(abs(y1),rf1);                          % short-time magnitude
Mn2 = conv(abs(y1),rf2);
Mn3 = conv(abs(y1),rf3);
Mn4 = conv(abs(y1),rf4);

y1_shift =  [0;y1(1:1:endpoint-1)];
firstDiff = sgn(y1)-sgn(y1_shift);
absFirstDiff = abs(firstDiff);
Zn1 = conv(absFirstDiff,rf1);                     % short-time zero-crossing
Zn2 = conv(absFirstDiff,rf2);
Zn3 = conv(absFirstDiff,rf3);
Zn4 = conv(absFirstDiff,rf4);

subplot(4,1,1); plot(t1/fs1,y1);
title('s5.wav Speech Waveform');
legend('signal');
ylabel('Amplitude');
axis([0 1.1 -1.5E4 1.5E4]);

subplot(4,1,2); 
plot(t_reduce/fs1,En1(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,En2(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,En3(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,En4(t_reduce),'LineWidth',2);
legend('duration: 5msec','duration: 10msec','duration: 20msec','duration: 40msec');
ylabel('Short-time Energy');
axis([0 1.1 0 10E9]);

subplot(4,1,3); 
plot(t_reduce/fs1,Mn1(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Mn2(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Mn3(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Mn4(t_reduce),'LineWidth',2);
legend('duration: 5msec','duration: 10msec','duration: 20msec','duration: 40msec');
ylabel('Short-time Magnitude');
axis([0 1.1 0 20E5]);

subplot(4,1,4); 
plot(t_reduce/fs1,Zn1(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Zn2(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Zn3(t_reduce),'LineWidth',2); hold on
plot(t_reduce/fs1,Zn4(t_reduce),'LineWidth',2);
legend('duration: 5msec','duration: 10msec','duration: 20msec','duration: 40msec');
xlabel('Time (sec)');
ylabel('Short-time Zero-crossing');
axis([0 1.1 0 600]);

##### SOURCE END #####
--></body></html>